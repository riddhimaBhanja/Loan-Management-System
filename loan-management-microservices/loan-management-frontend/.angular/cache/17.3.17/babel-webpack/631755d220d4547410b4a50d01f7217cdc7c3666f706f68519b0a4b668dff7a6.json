{"ast":null,"code":"import { signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { PageHeaderComponent } from '@shared/components/page-header/page-header.component';\nimport { InrCurrencyPipe } from '@shared/pipes/inr-currency.pipe';\nimport { LoanTypeFormDialogComponent } from './loan-type-form-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@core/services/loan-type.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/table\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/icon\";\nimport * as i8 from \"@angular/material/chips\";\nimport * as i9 from \"@angular/material/progress-spinner\";\nimport * as i10 from \"@angular/material/tooltip\";\nfunction LoanTypeListComponent_th_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"ID\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r1 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(type_r1.id);\n  }\n}\nfunction LoanTypeListComponent_th_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Name\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r2 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(type_r2.name);\n  }\n}\nfunction LoanTypeListComponent_th_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Description\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r3 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(type_r3.description);\n  }\n}\nfunction LoanTypeListComponent_th_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Amount Range\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"inrCurrency\");\n    i0.ɵɵpipe(3, \"inrCurrency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", i0.ɵɵpipeBind1(2, 2, type_r4.minAmount), \" - \", i0.ɵɵpipeBind1(3, 4, type_r4.maxAmount), \" \");\n  }\n}\nfunction LoanTypeListComponent_th_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Tenure (Months)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r5 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", type_r5.minTenureMonths, \" - \", type_r5.maxTenureMonths, \" \");\n  }\n}\nfunction LoanTypeListComponent_th_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Interest Rate\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const type_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"\", type_r6.interestRate, \"% p.a.\");\n  }\n}\nfunction LoanTypeListComponent_th_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Status\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 20)(1, \"mat-chip\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const type_r7 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"active-chip\", type_r7.isActive)(\"inactive-chip\", !type_r7.isActive);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", type_r7.isActive ? \"Active\" : \"Inactive\", \" \");\n  }\n}\nfunction LoanTypeListComponent_th_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 19);\n    i0.ɵɵtext(1, \"Actions\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_td_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 20)(1, \"div\", 21)(2, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function LoanTypeListComponent_td_31_Template_button_click_2_listener() {\n      const type_r9 = i0.ɵɵrestoreView(_r8).$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.openEditDialog(type_r9));\n    });\n    i0.ɵɵelementStart(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"edit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function LoanTypeListComponent_td_31_Template_button_click_5_listener() {\n      const type_r9 = i0.ɵɵrestoreView(_r8).$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.toggleLoanTypeStatus(type_r9));\n    });\n    i0.ɵɵelementStart(6, \"mat-icon\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const type_r9 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"color\", type_r9.isActive ? \"warn\" : \"accent\")(\"matTooltip\", type_r9.isActive ? \"Deactivate Loan Type\" : \"Activate Loan Type\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(type_r9.isActive ? \"block\" : \"check_circle\");\n  }\n}\nfunction LoanTypeListComponent_tr_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 24);\n  }\n}\nfunction LoanTypeListComponent_tr_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 25);\n  }\n}\nfunction LoanTypeListComponent_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵelement(1, \"mat-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoanTypeListComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"inbox\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4, \"No loan types found\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let LoanTypeListComponent = /*#__PURE__*/(() => {\n  class LoanTypeListComponent {\n    constructor(loanTypeService, snackBar, dialog) {\n      this.loanTypeService = loanTypeService;\n      this.snackBar = snackBar;\n      this.dialog = dialog;\n      this.loanTypes = signal([]);\n      this.isLoading = signal(false);\n      this.displayedColumns = ['id', 'name', 'description', 'amountRange', 'tenureRange', 'interestRate', 'isActive', 'actions'];\n    }\n    ngOnInit() {\n      this.loadLoanTypes();\n    }\n    loadLoanTypes() {\n      this.isLoading.set(true);\n      this.loanTypeService.getAllLoanTypes().subscribe({\n        next: response => {\n          if (response.success && response.data) {\n            this.loanTypes.set(response.data);\n          }\n          this.isLoading.set(false);\n        },\n        error: () => {\n          this.isLoading.set(false);\n        }\n      });\n    }\n    openCreateDialog() {\n      const dialogRef = this.dialog.open(LoanTypeFormDialogComponent, {\n        width: '700px',\n        disableClose: true,\n        data: {}\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result) {\n          this.loadLoanTypes();\n        }\n      });\n    }\n    openEditDialog(loanType) {\n      const dialogRef = this.dialog.open(LoanTypeFormDialogComponent, {\n        width: '700px',\n        disableClose: true,\n        data: {\n          loanType\n        }\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result) {\n          this.loadLoanTypes();\n        }\n      });\n    }\n    toggleLoanTypeStatus(loanType) {\n      const action = loanType.isActive ? 'deactivate' : 'activate';\n      const actionPast = loanType.isActive ? 'deactivated' : 'activated';\n      if (confirm(`Are you sure you want to ${action} loan type \"${loanType.name}\"?\\nThis action can be reversed later.`)) {\n        this.isLoading.set(true);\n        if (loanType.isActive) {\n          // Deactivate using DELETE endpoint\n          this.loanTypeService.deleteLoanType(loanType.id).subscribe({\n            next: () => {\n              this.handleToggleSuccess(actionPast);\n            },\n            error: error => {\n              this.handleToggleError(error, action);\n            }\n          });\n        } else {\n          // Activate using UPDATE endpoint with isActive: true\n          this.loanTypeService.updateLoanType(loanType.id, {\n            ...loanType,\n            isActive: true\n          }).subscribe({\n            next: () => {\n              this.handleToggleSuccess(actionPast);\n            },\n            error: error => {\n              this.handleToggleError(error, action);\n            }\n          });\n        }\n      }\n    }\n    handleToggleSuccess(actionPast) {\n      this.snackBar.open(`Loan type ${actionPast} successfully`, 'Close', {\n        duration: 3000,\n        panelClass: ['success-snackbar']\n      });\n      this.loadLoanTypes();\n    }\n    handleToggleError(error, action) {\n      console.error(`Error ${action}ing loan type:`, error);\n      this.isLoading.set(false);\n      // Extract error message from various possible structures\n      let errorMessage = `Failed to ${action} loan type`;\n      if (error.error) {\n        if (typeof error.error === 'string') {\n          errorMessage = error.error;\n        } else if (error.error.error && error.error.error.message) {\n          errorMessage = error.error.error.message;\n        } else if (error.error.message) {\n          errorMessage = error.error.message;\n        }\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      this.snackBar.open(errorMessage, 'Close', {\n        duration: 5000,\n        panelClass: ['error-snackbar']\n      });\n    }\n    static {\n      this.ɵfac = function LoanTypeListComponent_Factory(t) {\n        return new (t || LoanTypeListComponent)(i0.ɵɵdirectiveInject(i1.LoanTypeService), i0.ɵɵdirectiveInject(i2.MatSnackBar), i0.ɵɵdirectiveInject(i3.MatDialog));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: LoanTypeListComponent,\n        selectors: [[\"app-loan-type-list\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 36,\n        vars: 6,\n        consts: [[\"title\", \"Loan Type Management\", \"subtitle\", \"Manage loan types and configurations\", \"backRoute\", \"/dashboard\", 3, \"showBackButton\"], [\"actions\", \"\", \"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [1, \"content-container\"], [1, \"table-container\"], [\"mat-table\", \"\", 1, \"loan-types-table\", 3, \"dataSource\"], [\"matColumnDef\", \"id\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"name\"], [\"matColumnDef\", \"description\"], [\"matColumnDef\", \"amountRange\"], [\"matColumnDef\", \"tenureRange\"], [\"matColumnDef\", \"interestRate\"], [\"matColumnDef\", \"isActive\"], [\"matColumnDef\", \"actions\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"class\", \"loading-overlay\", 4, \"ngIf\"], [\"class\", \"no-data\", 4, \"ngIf\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [1, \"action-buttons\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Edit Loan Type\", 3, \"click\"], [\"mat-icon-button\", \"\", 3, \"click\", \"color\", \"matTooltip\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"], [1, \"loading-overlay\"], [1, \"no-data\"]],\n        template: function LoanTypeListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"app-page-header\", 0)(1, \"button\", 1);\n            i0.ɵɵlistener(\"click\", function LoanTypeListComponent_Template_button_click_1_listener() {\n              return ctx.openCreateDialog();\n            });\n            i0.ɵɵelementStart(2, \"mat-icon\");\n            i0.ɵɵtext(3, \"add\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(4, \" Create New Loan Type \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(5, \"div\", 2)(6, \"div\", 3)(7, \"table\", 4);\n            i0.ɵɵelementContainerStart(8, 5);\n            i0.ɵɵtemplate(9, LoanTypeListComponent_th_9_Template, 2, 0, \"th\", 6)(10, LoanTypeListComponent_td_10_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(11, 8);\n            i0.ɵɵtemplate(12, LoanTypeListComponent_th_12_Template, 2, 0, \"th\", 6)(13, LoanTypeListComponent_td_13_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(14, 9);\n            i0.ɵɵtemplate(15, LoanTypeListComponent_th_15_Template, 2, 0, \"th\", 6)(16, LoanTypeListComponent_td_16_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(17, 10);\n            i0.ɵɵtemplate(18, LoanTypeListComponent_th_18_Template, 2, 0, \"th\", 6)(19, LoanTypeListComponent_td_19_Template, 4, 6, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(20, 11);\n            i0.ɵɵtemplate(21, LoanTypeListComponent_th_21_Template, 2, 0, \"th\", 6)(22, LoanTypeListComponent_td_22_Template, 2, 2, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(23, 12);\n            i0.ɵɵtemplate(24, LoanTypeListComponent_th_24_Template, 2, 0, \"th\", 6)(25, LoanTypeListComponent_td_25_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(26, 13);\n            i0.ɵɵtemplate(27, LoanTypeListComponent_th_27_Template, 2, 0, \"th\", 6)(28, LoanTypeListComponent_td_28_Template, 3, 5, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(29, 14);\n            i0.ɵɵtemplate(30, LoanTypeListComponent_th_30_Template, 2, 0, \"th\", 6)(31, LoanTypeListComponent_td_31_Template, 8, 3, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵtemplate(32, LoanTypeListComponent_tr_32_Template, 1, 0, \"tr\", 15)(33, LoanTypeListComponent_tr_33_Template, 1, 0, \"tr\", 16);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(34, LoanTypeListComponent_div_34_Template, 2, 0, \"div\", 17)(35, LoanTypeListComponent_div_35_Template, 5, 0, \"div\", 18);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵproperty(\"showBackButton\", true);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"dataSource\", ctx.loanTypes());\n            i0.ɵɵadvance(25);\n            i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.isLoading() && ctx.loanTypes().length === 0);\n          }\n        },\n        dependencies: [CommonModule, i4.NgIf, MatTableModule, i5.MatTable, i5.MatHeaderCellDef, i5.MatHeaderRowDef, i5.MatColumnDef, i5.MatCellDef, i5.MatRowDef, i5.MatHeaderCell, i5.MatCell, i5.MatHeaderRow, i5.MatRow, MatButtonModule, i6.MatButton, i6.MatIconButton, MatIconModule, i7.MatIcon, MatChipsModule, i8.MatChip, MatProgressSpinnerModule, i9.MatProgressSpinner, MatSnackBarModule, MatTooltipModule, i10.MatTooltip, MatDialogModule, PageHeaderComponent, InrCurrencyPipe],\n        styles: [\".content-container[_ngcontent-%COMP%]{padding:32px 24px;position:relative;z-index:1;min-height:100vh}.content-container[_ngcontent-%COMP%]:before{content:\\\"\\\";position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(https://images.unsplash.com/photo-1526304640581-d334cdbbf45e?w=1920&q=95);background-size:cover;background-position:center;background-attachment:fixed;opacity:.35;z-index:-2;pointer-events:none;animation:_ngcontent-%COMP%_backgroundFloat 20s ease-in-out infinite}@keyframes _ngcontent-%COMP%_backgroundFloat{0%,to{transform:scale(1) translateY(0);opacity:.3}50%{transform:scale(1.05) translateY(-10px);opacity:.4}}.content-container[_ngcontent-%COMP%]:after{content:\\\"\\\";position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#667eea0a,#f093fb0a);z-index:-1;pointer-events:none}.table-container[_ngcontent-%COMP%]{position:relative;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 8px 32px #0000001a;overflow:hidden;border:1px solid rgba(255,255,255,.2)}.loan-types-table[_ngcontent-%COMP%]{width:100%}.active-chip[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.inactive-chip[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffc;display:flex;align-items:center;justify-content:center;z-index:10}.no-data[_ngcontent-%COMP%]{padding:48px;text-align:center;color:#0000008a}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:16px 0;font-size:16px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:transform .2s ease}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}\"]\n      });\n    }\n  }\n  return LoanTypeListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}