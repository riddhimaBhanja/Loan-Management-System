{"ast":null,"code":"import { signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { PageHeaderComponent } from '@shared/components/page-header/page-header.component';\nimport { InrCurrencyPipe } from '@shared/pipes/inr-currency.pipe';\nimport { StatusBadgePipe } from '@shared/pipes/status-badge.pipe';\nimport { PaymentDialogComponent } from './payment-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@core/services/emi.service\";\nimport * as i3 from \"@core/services/loan.service\";\nimport * as i4 from \"@core/services/auth.service\";\nimport * as i5 from \"@angular/material/dialog\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/table\";\nimport * as i8 from \"@angular/material/card\";\nimport * as i9 from \"@angular/material/chips\";\nimport * as i10 from \"@angular/material/icon\";\nimport * as i11 from \"@angular/material/button\";\nimport * as i12 from \"@angular/material/progress-spinner\";\nimport * as i13 from \"@angular/material/tooltip\";\nfunction EmiScheduleComponent_div_2_mat_card_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-card\", 22)(1, \"mat-card-content\")(2, \"div\", 31)(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"error\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 24)(6, \"p\", 25);\n    i0.ɵɵtext(7, \"Overdue EMIs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 26);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate(ctx_r0.getTotalOverdue());\n  }\n}\nfunction EmiScheduleComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"mat-card\", 22)(2, \"mat-card-content\")(3, \"div\", 23)(4, \"mat-icon\");\n    i0.ɵɵtext(5, \"account_balance_wallet\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 24)(7, \"p\", 25);\n    i0.ɵɵtext(8, \"Loan Amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\", 26);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"inrCurrency\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(12, \"mat-card\", 22)(13, \"mat-card-content\")(14, \"div\", 27)(15, \"mat-icon\");\n    i0.ɵɵtext(16, \"check_circle\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 24)(18, \"p\", 25);\n    i0.ɵɵtext(19, \"EMIs Paid\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"p\", 26);\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"p\", 28);\n    i0.ɵɵtext(23);\n    i0.ɵɵpipe(24, \"inrCurrency\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(25, \"mat-card\", 22)(26, \"mat-card-content\")(27, \"div\", 29)(28, \"mat-icon\");\n    i0.ɵɵtext(29, \"pending\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(30, \"div\", 24)(31, \"p\", 25);\n    i0.ɵɵtext(32, \"Pending EMIs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"p\", 26);\n    i0.ɵɵtext(34);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(35, EmiScheduleComponent_div_2_mat_card_35_Template, 10, 1, \"mat-card\", 30);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const loanData_r2 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(11, 6, loanData_r2.approvedAmount));\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.getTotalPaid(), \" / \", ctx_r0.emiSchedule().length, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(24, 8, ctx_r0.getTotalAmountPaid()));\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate(ctx_r0.getTotalPending());\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.getTotalOverdue() > 0);\n  }\n}\nfunction EmiScheduleComponent_th_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"EMI #\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r3 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(emi_r3.installmentNumber);\n  }\n}\nfunction EmiScheduleComponent_th_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Due Date\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(2, 1, emi_r4.dueDate, \"dd MMM yyyy\"));\n  }\n}\nfunction EmiScheduleComponent_th_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Principal\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"inrCurrency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r5 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, emi_r5.principalAmount));\n  }\n}\nfunction EmiScheduleComponent_th_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Interest\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"inrCurrency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, emi_r6.interestAmount));\n  }\n}\nfunction EmiScheduleComponent_th_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Total EMI\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"inrCurrency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r7 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, emi_r7.totalEmi));\n  }\n}\nfunction EmiScheduleComponent_th_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Balance\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"inrCurrency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r8 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, emi_r8.outstandingBalance));\n  }\n}\nfunction EmiScheduleComponent_th_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Status\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33)(1, \"mat-chip\", 35);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"statusBadge\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const emi_r9 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", ctx_r0.getStatusBadgeClass(emi_r9.status));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 2, emi_r9.status).text, \" \");\n  }\n}\nfunction EmiScheduleComponent_th_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Actions\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_28_Conditional_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function EmiScheduleComponent_td_28_Conditional_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const emi_r11 = i0.ɵɵnextContext().$implicit;\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.openPaymentDialog(emi_r11));\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"payment\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction EmiScheduleComponent_td_28_Conditional_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\", 37);\n    i0.ɵɵtext(1, \"check_circle\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_td_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtemplate(1, EmiScheduleComponent_td_28_Conditional_1_Template, 3, 0, \"button\", 36)(2, EmiScheduleComponent_td_28_Conditional_2_Template, 2, 0, \"mat-icon\", 37);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const emi_r11 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵconditional(1, ctx_r0.canPayEmi(emi_r11) ? 1 : -1);\n    i0.ɵɵadvance();\n    i0.ɵɵconditional(2, emi_r11.status === \"PAID\" ? 2 : -1);\n  }\n}\nfunction EmiScheduleComponent_tr_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 39);\n  }\n}\nfunction EmiScheduleComponent_tr_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 40);\n  }\n  if (rf & 2) {\n    const row_r12 = ctx.$implicit;\n    i0.ɵɵclassProp(\"paid-row\", row_r12.status === \"PAID\")(\"overdue-row\", row_r12.status === \"OVERDUE\");\n  }\n}\nfunction EmiScheduleComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41);\n    i0.ɵɵelement(1, \"mat-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 42)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"inbox\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4, \"No EMI schedule found for this loan\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_th_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Payment Date\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_td_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const payment_r13 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(2, 1, payment_r13.paymentDate, \"dd MMM yyyy\"));\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_th_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Amount\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"inrCurrency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const payment_r14 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, payment_r14.paymentAmount));\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_th_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Method\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_td_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33)(1, \"mat-chip\", 51);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const payment_r15 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.getPaymentMethodLabel(payment_r15.paymentMethod));\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_th_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Transaction Ref\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_td_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const payment_r16 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(payment_r16.transactionReference || \"-\");\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_th_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 32);\n    i0.ɵɵtext(1, \"Recorded By\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_td_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const payment_r17 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(payment_r17.recordedByName);\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 39);\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 40);\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41);\n    i0.ɵɵelement(1, \"mat-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EmiScheduleComponent_Conditional_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20)(1, \"h2\", 43)(2, \"mat-icon\");\n    i0.ɵɵtext(3, \"history\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" Payment History \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 3)(6, \"table\", 44);\n    i0.ɵɵelementContainerStart(7, 45);\n    i0.ɵɵtemplate(8, EmiScheduleComponent_Conditional_33_th_8_Template, 2, 0, \"th\", 6)(9, EmiScheduleComponent_Conditional_33_td_9_Template, 3, 4, \"td\", 7);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(10, 46);\n    i0.ɵɵtemplate(11, EmiScheduleComponent_Conditional_33_th_11_Template, 2, 0, \"th\", 6)(12, EmiScheduleComponent_Conditional_33_td_12_Template, 3, 3, \"td\", 12);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(13, 47);\n    i0.ɵɵtemplate(14, EmiScheduleComponent_Conditional_33_th_14_Template, 2, 0, \"th\", 6)(15, EmiScheduleComponent_Conditional_33_td_15_Template, 3, 1, \"td\", 7);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(16, 48);\n    i0.ɵɵtemplate(17, EmiScheduleComponent_Conditional_33_th_17_Template, 2, 0, \"th\", 6)(18, EmiScheduleComponent_Conditional_33_td_18_Template, 2, 1, \"td\", 7);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(19, 49);\n    i0.ɵɵtemplate(20, EmiScheduleComponent_Conditional_33_th_20_Template, 2, 0, \"th\", 6)(21, EmiScheduleComponent_Conditional_33_td_21_Template, 2, 1, \"td\", 7);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(22, EmiScheduleComponent_Conditional_33_tr_22_Template, 1, 0, \"tr\", 16)(23, EmiScheduleComponent_Conditional_33_tr_23_Template, 1, 0, \"tr\", 50);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(24, EmiScheduleComponent_Conditional_33_div_24_Template, 2, 0, \"div\", 18);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"dataSource\", ctx_r0.paymentHistory());\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r0.paymentColumns);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r0.paymentColumns);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isLoadingPayments());\n  }\n}\nexport let EmiScheduleComponent = /*#__PURE__*/(() => {\n  class EmiScheduleComponent {\n    constructor(route, emiService, loanService, authService, dialog) {\n      this.route = route;\n      this.emiService = emiService;\n      this.loanService = loanService;\n      this.authService = authService;\n      this.dialog = dialog;\n      this.emiSchedule = signal([]);\n      this.paymentHistory = signal([]);\n      this.loan = signal(null);\n      this.isLoading = signal(true);\n      this.isLoadingPayments = signal(false);\n      this.displayedColumns = ['emiNumber', 'dueDate', 'principalAmount', 'interestAmount', 'totalEmi', 'principalBalance', 'status', 'actions'];\n      this.paymentColumns = ['paymentDate', 'paymentAmount', 'paymentMethod', 'transactionReference', 'recordedBy'];\n    }\n    ngOnInit() {\n      const loanId = this.route.snapshot.params['loanId'];\n      this.loadLoanDetails(loanId);\n      this.loadEmiSchedule(loanId);\n      this.loadPaymentHistory(loanId);\n    }\n    loadLoanDetails(loanId) {\n      this.loanService.getLoanById(loanId).subscribe({\n        next: response => {\n          if (response.success && response.data) {\n            this.loan.set(response.data);\n          }\n        }\n      });\n    }\n    loadEmiSchedule(loanId) {\n      this.isLoading.set(true);\n      this.emiService.getEmiSchedule(loanId).subscribe({\n        next: response => {\n          if (response.success && response.data) {\n            this.emiSchedule.set(response.data);\n          }\n          this.isLoading.set(false);\n        },\n        error: () => {\n          this.isLoading.set(false);\n        }\n      });\n    }\n    loadPaymentHistory(loanId) {\n      this.isLoadingPayments.set(true);\n      this.emiService.getPaymentHistory(loanId).subscribe({\n        next: response => {\n          if (response.success && response.data) {\n            this.paymentHistory.set(response.data);\n          }\n          this.isLoadingPayments.set(false);\n        },\n        error: () => {\n          this.isLoadingPayments.set(false);\n        }\n      });\n    }\n    getTotalPaid() {\n      return this.emiSchedule().filter(emi => emi.status === 'PAID').length;\n    }\n    getTotalPending() {\n      return this.emiSchedule().filter(emi => emi.status === 'PENDING').length;\n    }\n    getTotalOverdue() {\n      return this.emiSchedule().filter(emi => emi.status === 'OVERDUE').length;\n    }\n    getTotalAmountPaid() {\n      return this.emiSchedule().filter(emi => emi.status === 'PAID').reduce((sum, emi) => sum + Number(emi.totalEmi), 0);\n    }\n    getStatusBadgeClass(status) {\n      const statusMap = {\n        'PENDING': 'status-warning',\n        'PAID': 'status-success',\n        'OVERDUE': 'status-danger',\n        'PARTIAL': 'status-info'\n      };\n      return statusMap[status] || 'status-default';\n    }\n    canRecordPayment() {\n      return this.authService.hasRole('ADMIN') || this.authService.hasRole('LOAN_OFFICER');\n    }\n    canPayEmi(emi) {\n      return this.canRecordPayment() && (emi.status === 'PENDING' || emi.status === 'OVERDUE');\n    }\n    openPaymentDialog(emi) {\n      const dialogRef = this.dialog.open(PaymentDialogComponent, {\n        width: '600px',\n        disableClose: true,\n        data: {\n          emiSchedule: emi\n        }\n      });\n      dialogRef.afterClosed().subscribe(result => {\n        if (result) {\n          // Reload the EMI schedule and payment history after successful payment\n          const loanId = this.route.snapshot.params['loanId'];\n          this.loadEmiSchedule(loanId);\n          this.loadPaymentHistory(loanId);\n        }\n      });\n    }\n    getPaymentMethodLabel(method) {\n      const methodMap = {\n        'CASH': 'Cash',\n        'CHEQUE': 'Cheque',\n        'NEFT': 'NEFT',\n        'RTGS': 'RTGS',\n        'UPI': 'UPI',\n        'DEBIT_CARD': 'Debit Card',\n        'CREDIT_CARD': 'Credit Card',\n        'NET_BANKING': 'Net Banking',\n        'DEMAND_DRAFT': 'Demand Draft'\n      };\n      return methodMap[method] || method;\n    }\n    static {\n      this.ɵfac = function EmiScheduleComponent_Factory(t) {\n        return new (t || EmiScheduleComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.EmiService), i0.ɵɵdirectiveInject(i3.LoanService), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i5.MatDialog));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: EmiScheduleComponent,\n        selectors: [[\"app-emi-schedule\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 34,\n        vars: 9,\n        consts: [[\"subtitle\", \"View complete EMI payment schedule\", \"backRoute\", \"/dashboard\", 3, \"title\", \"showBackButton\"], [1, \"content-container\"], [\"class\", \"summary-cards\", 4, \"ngIf\"], [1, \"table-container\"], [\"mat-table\", \"\", 1, \"emi-table\", 3, \"dataSource\"], [\"matColumnDef\", \"emiNumber\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"dueDate\"], [\"matColumnDef\", \"principalAmount\"], [\"matColumnDef\", \"interestAmount\"], [\"matColumnDef\", \"totalEmi\"], [\"mat-cell\", \"\", \"class\", \"amount-cell\", 4, \"matCellDef\"], [\"matColumnDef\", \"principalBalance\"], [\"matColumnDef\", \"status\"], [\"matColumnDef\", \"actions\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 3, \"paid-row\", \"overdue-row\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"class\", \"loading-overlay\", 4, \"ngIf\"], [\"class\", \"no-data\", 4, \"ngIf\"], [1, \"payment-history-container\"], [1, \"summary-cards\"], [1, \"summary-card\"], [1, \"card-icon\", \"primary\"], [1, \"card-details\"], [1, \"card-label\"], [1, \"card-value\"], [1, \"card-icon\", \"success\"], [1, \"card-sublabel\"], [1, \"card-icon\", \"warning\"], [\"class\", \"summary-card\", 4, \"ngIf\"], [1, \"card-icon\", \"danger\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [\"mat-cell\", \"\", 1, \"amount-cell\"], [3, \"ngClass\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Record Payment\"], [\"matTooltip\", \"Payment Completed\", 1, \"paid-icon\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Record Payment\", 3, \"click\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"], [1, \"loading-overlay\"], [1, \"no-data\"], [1, \"section-title\"], [\"mat-table\", \"\", 1, \"payment-table\", 3, \"dataSource\"], [\"matColumnDef\", \"paymentDate\"], [\"matColumnDef\", \"paymentAmount\"], [\"matColumnDef\", \"paymentMethod\"], [\"matColumnDef\", \"transactionReference\"], [\"matColumnDef\", \"recordedBy\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [1, \"method-chip\"]],\n        template: function EmiScheduleComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelement(0, \"app-page-header\", 0);\n            i0.ɵɵelementStart(1, \"div\", 1);\n            i0.ɵɵtemplate(2, EmiScheduleComponent_div_2_Template, 36, 10, \"div\", 2);\n            i0.ɵɵelementStart(3, \"div\", 3)(4, \"table\", 4);\n            i0.ɵɵelementContainerStart(5, 5);\n            i0.ɵɵtemplate(6, EmiScheduleComponent_th_6_Template, 2, 0, \"th\", 6)(7, EmiScheduleComponent_td_7_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(8, 8);\n            i0.ɵɵtemplate(9, EmiScheduleComponent_th_9_Template, 2, 0, \"th\", 6)(10, EmiScheduleComponent_td_10_Template, 3, 4, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(11, 9);\n            i0.ɵɵtemplate(12, EmiScheduleComponent_th_12_Template, 2, 0, \"th\", 6)(13, EmiScheduleComponent_td_13_Template, 3, 3, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(14, 10);\n            i0.ɵɵtemplate(15, EmiScheduleComponent_th_15_Template, 2, 0, \"th\", 6)(16, EmiScheduleComponent_td_16_Template, 3, 3, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(17, 11);\n            i0.ɵɵtemplate(18, EmiScheduleComponent_th_18_Template, 2, 0, \"th\", 6)(19, EmiScheduleComponent_td_19_Template, 3, 3, \"td\", 12);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(20, 13);\n            i0.ɵɵtemplate(21, EmiScheduleComponent_th_21_Template, 2, 0, \"th\", 6)(22, EmiScheduleComponent_td_22_Template, 3, 3, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(23, 14);\n            i0.ɵɵtemplate(24, EmiScheduleComponent_th_24_Template, 2, 0, \"th\", 6)(25, EmiScheduleComponent_td_25_Template, 4, 4, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(26, 15);\n            i0.ɵɵtemplate(27, EmiScheduleComponent_th_27_Template, 2, 0, \"th\", 6)(28, EmiScheduleComponent_td_28_Template, 3, 2, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵtemplate(29, EmiScheduleComponent_tr_29_Template, 1, 0, \"tr\", 16)(30, EmiScheduleComponent_tr_30_Template, 1, 4, \"tr\", 17);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(31, EmiScheduleComponent_div_31_Template, 2, 0, \"div\", 18)(32, EmiScheduleComponent_div_32_Template, 5, 0, \"div\", 19);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(33, EmiScheduleComponent_Conditional_33_Template, 25, 4, \"div\", 20);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            let tmp_0_0;\n            i0.ɵɵproperty(\"title\", \"EMI Schedule - \" + (((tmp_0_0 = ctx.loan()) == null ? null : tmp_0_0.applicationNumber) || \"\"))(\"showBackButton\", true);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.loan());\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"dataSource\", ctx.emiSchedule());\n            i0.ɵɵadvance(25);\n            i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.isLoading() && ctx.emiSchedule().length === 0);\n            i0.ɵɵadvance();\n            i0.ɵɵconditional(33, ctx.paymentHistory().length > 0 ? 33 : -1);\n          }\n        },\n        dependencies: [CommonModule, i6.NgClass, i6.NgIf, i6.DatePipe, RouterModule, MatTableModule, i7.MatTable, i7.MatHeaderCellDef, i7.MatHeaderRowDef, i7.MatColumnDef, i7.MatCellDef, i7.MatRowDef, i7.MatHeaderCell, i7.MatCell, i7.MatHeaderRow, i7.MatRow, MatCardModule, i8.MatCard, i8.MatCardContent, MatChipsModule, i9.MatChip, MatIconModule, i10.MatIcon, MatButtonModule, i11.MatIconButton, MatProgressSpinnerModule, i12.MatProgressSpinner, MatDialogModule, MatTooltipModule, i13.MatTooltip, PageHeaderComponent, InrCurrencyPipe, StatusBadgePipe],\n        styles: [\".content-container[_ngcontent-%COMP%]{padding:32px 24px;max-width:1400px;margin:0 auto;position:relative;z-index:1;min-height:100vh}.content-container[_ngcontent-%COMP%]:before{content:\\\"\\\";position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?w=1920&q=80);background-size:cover;background-position:center;background-attachment:fixed;opacity:.13;z-index:-2;pointer-events:none}.content-container[_ngcontent-%COMP%]:after{content:\\\"\\\";position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#667eea0d,#4facfe0d);z-index:-1;pointer-events:none}.summary-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;margin-bottom:40px}.summary-card[_ngcontent-%COMP%]{background:#fffffff2!important;-webkit-backdrop-filter:blur(10px)!important;backdrop-filter:blur(10px)!important;border-radius:20px!important;border:1px solid rgba(255,255,255,.2);transition:all .3s ease;position:relative;overflow:hidden}.summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 40px #00000026!important}.summary-card[_ngcontent-%COMP%]:before{content:\\\"\\\";position:absolute;top:-50%;right:-20%;width:150px;height:150px;border-radius:50%;opacity:.1;transition:all .3s ease}.summary-card[_ngcontent-%COMP%]:hover:before{width:200px;height:200px}.summary-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;padding:24px!important;position:relative;z-index:1}.summary-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:16px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a;transition:transform .3s ease}.summary-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#fff}.summary-card[_ngcontent-%COMP%]   .card-icon.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.summary-card[_ngcontent-%COMP%]   .card-icon.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#81c784,#4caf50)}.summary-card[_ngcontent-%COMP%]   .card-icon.warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffb74d,#ff9800)}.summary-card[_ngcontent-%COMP%]   .card-icon.danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e57373,#f44336)}.summary-card[_ngcontent-%COMP%]:hover   .card-icon[_ngcontent-%COMP%]{transform:scale(1.1) rotate(5deg)}.summary-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]{flex:1}.summary-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .card-label[_ngcontent-%COMP%]{margin:0 0 6px;font-size:14px;color:#0009;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.summary-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:700;color:#333;line-height:1}.summary-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .card-sublabel[_ngcontent-%COMP%]{margin:8px 0 0;font-size:13px;color:#00000080}.table-container[_ngcontent-%COMP%]{position:relative;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 8px 32px #0000001a;overflow:hidden;border:1px solid rgba(255,255,255,.2)}.emi-table[_ngcontent-%COMP%]{width:100%}.emi-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.emi-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#fff!important;padding:18px 16px;font-size:14px;text-transform:uppercase;letter-spacing:.5px}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid rgba(0,0,0,.05);font-weight:500}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .amount-cell[_ngcontent-%COMP%]{font-weight:700;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:15px}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .2s ease;background:#fff}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,rgba(102,126,234,.05) 0%,transparent 100%);transform:scale(1.002)}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.paid-row[_ngcontent-%COMP%]{background:#4caf500f;border-left:4px solid #4CAF50}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.paid-row[_ngcontent-%COMP%]:hover{background:#4caf501a}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.overdue-row[_ngcontent-%COMP%]{background:#f443360f;border-left:4px solid #F44336}.emi-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.overdue-row[_ngcontent-%COMP%]:hover{background:#f443361a}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;z-index:10}.no-data[_ngcontent-%COMP%]{padding:64px;text-align:center;color:#0000008a}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:72px;width:72px;height:72px;margin-bottom:24px;opacity:.4;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:20px 0;font-size:17px;font-weight:500}mat-chip[_ngcontent-%COMP%]{border-radius:16px!important;font-weight:600!important;padding:6px 16px!important;letter-spacing:.5px;box-shadow:0 2px 8px #0000001a}mat-chip.status-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffb74d,#ff9800)!important;color:#fff!important}mat-chip.status-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#81c784,#4caf50)!important;color:#fff!important}mat-chip.status-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e57373,#f44336)!important;color:#fff!important}mat-chip.status-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#64b5f6,#2196f3)!important;color:#fff!important}.paid-icon[_ngcontent-%COMP%]{color:#4caf50;font-size:24px;width:24px;height:24px;cursor:default}.payment-history-container[_ngcontent-%COMP%]{margin-top:40px}.payment-history-container[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:700;color:#333;margin-bottom:24px;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.payment-history-container[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:28px;width:28px;height:28px}.payment-table[_ngcontent-%COMP%]{width:100%}.payment-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#66bb6a)}.payment-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#fff!important;padding:18px 16px;font-size:14px;text-transform:uppercase;letter-spacing:.5px}.payment-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid rgba(0,0,0,.05);font-weight:500}.payment-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .2s ease;background:#fff}.payment-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,rgba(76,175,80,.05) 0%,transparent 100%);transform:scale(1.002)}.method-chip[_ngcontent-%COMP%]{background:linear-gradient(135deg,#64b5f6,#2196f3)!important;color:#fff!important;font-weight:600!important;padding:6px 12px!important;border-radius:12px!important;font-size:12px!important;box-shadow:0 2px 6px #2196f34d}@media (max-width: 768px){.content-container[_ngcontent-%COMP%]{padding:20px 16px}.summary-cards[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px;margin-bottom:32px}.summary-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{width:56px;height:56px}.summary-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.summary-card[_ngcontent-%COMP%]   .card-details[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]{font-size:24px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.table-container[_ngcontent-%COMP%]   .emi-table[_ngcontent-%COMP%]{min-width:800px}}\"]\n      });\n    }\n  }\n  return EmiScheduleComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}