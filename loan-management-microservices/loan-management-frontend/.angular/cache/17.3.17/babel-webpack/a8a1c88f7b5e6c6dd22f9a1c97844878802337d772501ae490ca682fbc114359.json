{"ast":null,"code":"import { map } from 'rxjs/operators';\nimport { environment } from '@environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class EmiService {\n  constructor(http) {\n    this.http = http;\n    this.API_URL = `${environment.apiUrl}/emis`;\n  }\n  /**\n   * Transform backend EMI schedule response to frontend model\n   */\n  transformEmiSchedule(backendEmi) {\n    return {\n      id: backendEmi.id,\n      loanId: backendEmi.loanId,\n      customerId: backendEmi.customerId,\n      installmentNumber: backendEmi.emiNumber,\n      dueDate: backendEmi.dueDate,\n      principalAmount: backendEmi.principalComponent,\n      interestAmount: backendEmi.interestComponent,\n      totalEmi: backendEmi.emiAmount,\n      outstandingBalance: backendEmi.outstandingBalance,\n      status: backendEmi.status,\n      createdAt: backendEmi.createdAt,\n      updatedAt: backendEmi.updatedAt\n    };\n  }\n  /**\n   * Transform backend payment response to frontend model\n   */\n  transformEmiPayment(backendPayment) {\n    return {\n      id: backendPayment.id,\n      emiScheduleId: backendPayment.emiScheduleId,\n      loanId: backendPayment.loanId,\n      emiNumber: backendPayment.emiNumber,\n      paymentAmount: backendPayment.amount,\n      paymentDate: backendPayment.paymentDate,\n      paymentMethod: backendPayment.paymentMethod,\n      transactionReference: backendPayment.transactionReference,\n      remarks: backendPayment.remarks,\n      recordedById: backendPayment.paidBy,\n      recordedByName: backendPayment.paidByName,\n      createdAt: backendPayment.createdAt\n    };\n  }\n  /**\n   * Get EMI schedule for a specific loan\n   */\n  getEmiSchedule(loanId) {\n    return this.http.get(`${this.API_URL}/loan/${loanId}`).pipe(map(response => ({\n      ...response,\n      data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n    })));\n  }\n  /**\n   * Get EMI schedule for all loans of the current user (Customer)\n   */\n  getMyEmiSchedule() {\n    return this.http.get(`${this.API_URL}/my-schedule`).pipe(map(response => ({\n      ...response,\n      data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n    })));\n  }\n  /**\n   * Get all pending EMIs for the current customer\n   */\n  getPendingEmis() {\n    return this.http.get(`${this.API_URL}/pending`).pipe(map(response => ({\n      ...response,\n      data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n    })));\n  }\n  /**\n   * Get all overdue EMIs across all customers (Admin/Loan Officer only)\n   */\n  getOverdueEmis() {\n    return this.http.get(`${this.API_URL}/overdue`).pipe(map(response => ({\n      ...response,\n      data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n    })));\n  }\n  /**\n   * Record EMI payment (Admin/Loan Officer only)\n   */\n  recordPayment(request) {\n    return this.http.post(`${this.API_URL}/pay`, request).pipe(map(response => ({\n      ...response,\n      data: response.data ? this.transformEmiPayment(response.data) : undefined\n    })));\n  }\n  /**\n   * Get payment history for a specific loan\n   */\n  getPaymentHistory(loanId) {\n    return this.http.get(`${this.API_URL}/loan/${loanId}/payments`).pipe(map(response => ({\n      ...response,\n      data: response.data ? response.data.map(payment => this.transformEmiPayment(payment)) : []\n    })));\n  }\n  static {\n    this.ɵfac = function EmiService_Factory(t) {\n      return new (t || EmiService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: EmiService,\n      factory: EmiService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["map","environment","EmiService","constructor","http","API_URL","apiUrl","transformEmiSchedule","backendEmi","id","loanId","customerId","installmentNumber","emiNumber","dueDate","principalAmount","principalComponent","interestAmount","interestComponent","totalEmi","emiAmount","outstandingBalance","status","createdAt","updatedAt","transformEmiPayment","backendPayment","emiScheduleId","paymentAmount","amount","paymentDate","paymentMethod","transactionReference","remarks","recordedById","paidBy","recordedByName","paidByName","getEmiSchedule","get","pipe","response","data","emi","getMyEmiSchedule","getPendingEmis","getOverdueEmis","recordPayment","request","post","undefined","getPaymentHistory","payment","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\KIIT\\Desktop\\Loan Management System\\loan-management-frontend\\src\\app\\core\\services\\emi.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { environment } from '@environments/environment';\nimport { EmiSchedule, EmiScheduleBackendResponse, EmiPayment, EmiPaymentBackendResponse, EmiPaymentRequest } from '../models/emi.model';\nimport { ApiResponse } from '../models/api-response.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EmiService {\n  private readonly API_URL = `${environment.apiUrl}/emis`;\n\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Transform backend EMI schedule response to frontend model\n   */\n  private transformEmiSchedule(backendEmi: EmiScheduleBackendResponse): EmiSchedule {\n    return {\n      id: backendEmi.id,\n      loanId: backendEmi.loanId,\n      customerId: backendEmi.customerId,\n      installmentNumber: backendEmi.emiNumber,\n      dueDate: backendEmi.dueDate,\n      principalAmount: backendEmi.principalComponent,\n      interestAmount: backendEmi.interestComponent,\n      totalEmi: backendEmi.emiAmount,\n      outstandingBalance: backendEmi.outstandingBalance,\n      status: backendEmi.status,\n      createdAt: backendEmi.createdAt,\n      updatedAt: backendEmi.updatedAt\n    };\n  }\n\n  /**\n   * Transform backend payment response to frontend model\n   */\n  private transformEmiPayment(backendPayment: EmiPaymentBackendResponse): EmiPayment {\n    return {\n      id: backendPayment.id,\n      emiScheduleId: backendPayment.emiScheduleId,\n      loanId: backendPayment.loanId,\n      emiNumber: backendPayment.emiNumber,\n      paymentAmount: backendPayment.amount,\n      paymentDate: backendPayment.paymentDate,\n      paymentMethod: backendPayment.paymentMethod,\n      transactionReference: backendPayment.transactionReference,\n      remarks: backendPayment.remarks,\n      recordedById: backendPayment.paidBy,\n      recordedByName: backendPayment.paidByName,\n      createdAt: backendPayment.createdAt\n    };\n  }\n\n  /**\n   * Get EMI schedule for a specific loan\n   */\n  getEmiSchedule(loanId: number): Observable<ApiResponse<EmiSchedule[]>> {\n    return this.http.get<ApiResponse<EmiScheduleBackendResponse[]>>(`${this.API_URL}/loan/${loanId}`).pipe(\n      map(response => ({\n        ...response,\n        data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n      }))\n    );\n  }\n\n  /**\n   * Get EMI schedule for all loans of the current user (Customer)\n   */\n  getMyEmiSchedule(): Observable<ApiResponse<EmiSchedule[]>> {\n    return this.http.get<ApiResponse<EmiScheduleBackendResponse[]>>(`${this.API_URL}/my-schedule`).pipe(\n      map(response => ({\n        ...response,\n        data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n      }))\n    );\n  }\n\n  /**\n   * Get all pending EMIs for the current customer\n   */\n  getPendingEmis(): Observable<ApiResponse<EmiSchedule[]>> {\n    return this.http.get<ApiResponse<EmiScheduleBackendResponse[]>>(`${this.API_URL}/pending`).pipe(\n      map(response => ({\n        ...response,\n        data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n      }))\n    );\n  }\n\n  /**\n   * Get all overdue EMIs across all customers (Admin/Loan Officer only)\n   */\n  getOverdueEmis(): Observable<ApiResponse<EmiSchedule[]>> {\n    return this.http.get<ApiResponse<EmiScheduleBackendResponse[]>>(`${this.API_URL}/overdue`).pipe(\n      map(response => ({\n        ...response,\n        data: response.data ? response.data.map(emi => this.transformEmiSchedule(emi)) : []\n      }))\n    );\n  }\n\n  /**\n   * Record EMI payment (Admin/Loan Officer only)\n   */\n  recordPayment(request: EmiPaymentRequest): Observable<ApiResponse<EmiPayment>> {\n    return this.http.post<ApiResponse<EmiPaymentBackendResponse>>(`${this.API_URL}/pay`, request).pipe(\n      map(response => ({\n        ...response,\n        data: response.data ? this.transformEmiPayment(response.data) : undefined\n      }))\n    );\n  }\n\n  /**\n   * Get payment history for a specific loan\n   */\n  getPaymentHistory(loanId: number): Observable<ApiResponse<EmiPayment[]>> {\n    return this.http.get<ApiResponse<EmiPaymentBackendResponse[]>>(`${this.API_URL}/loan/${loanId}/payments`).pipe(\n      map(response => ({\n        ...response,\n        data: response.data ? response.data.map(payment => this.transformEmiPayment(payment)) : []\n      }))\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}